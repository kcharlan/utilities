# LLM Usage Collector

This project is designed to collect and track usage data for Large Language Models (LLMs). It consists of a web browser extension, a data collection server, and a Docker container to run the server.

## Purpose

The primary purpose of this tool is to provide a self-hosted solution for tracking your own LLM usage across different web-based interfaces. This can be useful for:

*   Understanding your own usage patterns.
*   Cost analysis if you are using paid LLM services.
*   Research on LLM usage.

## Folder Structure

*   `llm_usage_installation_guide_v1.1.md`: Full installation guide for macOS.
*   `llm_usage_tracker_handoff_guide_v1.1.md`: Handoff and developer guide.
*   `collector/`: Contains the Python-based data collection server.
*   `extension/`: Contains the browser extension that captures LLM usage data.
*   `llm_collector_container/`: Contains the Docker configuration and convenience scripts (`up.sh`, `down.sh`) for running the collection server.
*   `snapshots/`: Contains snapshots of the collected usage data. `snapshots.csv` is automatically updated here daily (or upon reset).

*   `MY_API_KEY.txt`: A file for you to store your API key for reference. It is not used by any script.
*   `state.json`: A file that stores the current state of the collector.
*   `collector.log`, `reset_launchd.log`, `reset_launchd.err`: Log files generated by the collector and the reset script.

## Guides

*   **[LLM Usage Tracker — Full Installation Guide (macOS)](llm_usage_installation_guide_v1.1.md)**: A comprehensive guide for setting up the entire project from scratch on macOS.
*   **[LLM Usage Tracker — Handoff and Developer Guide](llm_usage_tracker_handoff_guide_v1.1.md)**: Explains the system's operation, how to extend it, and its technical evolution.

## Quick Start

For a complete setup guide, please refer to the [LLM Usage Tracker — Full Installation Guide (macOS)](llm_usage_installation_guide_v1.1.md).

In brief:

1.  **Configure API Key**: Define your API key in `llm_collector_container/docker-compose.yml` and `extension/background.js`. You can use `MY_API_KEY.txt` to keep a copy of your key for your reference.
2.  **Start Collector**: Navigate to `llm_collector_container` and run `./up.sh`.

3.  **Install Extension**: Load the `extension` directory as an unpacked extension in your browser's developer mode.

## Usage

Once the collector and extension are running, the extension will automatically track your LLM usage in the browser.

*   The `reset_collector.sh` script (configured via `launchd` on macOS as per the installation guide) checks for active counters each day; it only performs the reset and triggers a snapshot when usage has been recorded, and otherwise exits without changes.
*   The collector automatically rolls up snapshots into `snapshots.csv` whenever a reset occurs (via the `/reset` endpoint). The `snapshots/rollup_snapshots.py` script remains available for manual invocations.


To view the collected data, you can access the following endpoints on the collector server:

*   **Counters:** `http://127.0.0.1:9000/counters` (requires `X-API-KEY` header)
*   **Reset:** `http://127.0.0.1:9000/reset` (requires `X-API-KEY` header)

## Contributing

Contributions are welcome! Please feel free to open an issue or submit a pull request.

## License

This project is licensed under the MIT License.
